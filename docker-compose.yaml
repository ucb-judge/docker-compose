###############################
#
#       UCB-JUDGE - v1.0
#
###############################

version: "3.7"
networks:
  network-ucb-judge:
    external: true

services:
  service-discovery:
    image: ucb-judge-service-discovery:1.0.0
    environment:
      CONFIG_SERVER_URI: ${CONFIG_SERVER_BASE_URI}
      CONFIG_SERVER_USER: ${CONFIG_SERVER_USER}
      CONFIG_SERVER_PASSWORD: ${CONFIG_SERVER_PASSWORD}
      EUREKA_SERVER_URI: ${EUREKA_SERVER_URI}
      CONFIG_SERVER_PROFILE: ${CONFIG_SERVER_PROFILE}
      ZIPKIN_SERVER_URI: ${ZIPKIN_SERVER_URI}
    networks:
      - network-ucb-judge
  gateway:
    image: ucb-judge-gateway:1.0.0
    ports:
      - "8282:8282"
    environment:
      CONFIG_SERVER_URI: ${CONFIG_SERVER_BASE_URI}
      CONFIG_SERVER_USER: ${CONFIG_SERVER_USER}
      CONFIG_SERVER_PASSWORD: ${CONFIG_SERVER_PASSWORD}
      EUREKA_SERVER_URI: ${EUREKA_SERVER_URI}
      CONFIG_SERVER_PROFILE: ${CONFIG_SERVER_PROFILE}
      ZIPKIN_SERVER_URI: ${ZIPKIN_SERVER_URI}
    depends_on:
      - service-discovery
    networks:
      - network-ucb-judge
  users:
    image: ucb-judge-users:1.0.0
    environment:
      CONFIG_SERVER_URI: ${CONFIG_SERVER_BASE_URI}
      CONFIG_SERVER_USER: ${CONFIG_SERVER_USER}
      CONFIG_SERVER_PASSWORD: ${CONFIG_SERVER_PASSWORD}
      EUREKA_SERVER_URI: ${EUREKA_SERVER_URI}
      CONFIG_SERVER_PROFILE: ${CONFIG_SERVER_PROFILE}
      ZIPKIN_SERVER_URI: ${ZIPKIN_SERVER_URI}
      KEYCLOAK_SERVER_URI: ${KEYCLOAK_SERVER_URI}
      KEYCLOAK_CLIENT_SECRET: ${KEYCLOAK_CLIENT_SECRET}
    depends_on:
      - service-discovery
    networks:
      - network-ucb-judge